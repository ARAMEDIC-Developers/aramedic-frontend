<%- include('../_partials/header') %>

<div class="dashboard-container">
    <%- include('../_partials/sidebar') %>

    <!-- Contenido Principal -->
    <main id="main-content">
        <%- include('../_partials/sub_header') %>
        <!-- Lista de Notificaciones -->
        <%- include('../_partials/notificaciones') %>

        <div class="main-content">
            <h2 class="section-title">Citas Médicas</h2>

            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" placeholder="Buscar cita...">
            </div>

            <button id="btnAgregarCitas" class="add-button">
                <i class="fas fa-plus-circle"></i> Agendar Cita
            </button>

            <div class="table-container">
                <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                    <thead style="background-color: #007BFF; color: white;">
                        <tr>
                            <th style="padding: 10px; text-align: left;">Paciente</th>
                            <th style="padding: 10px; text-align: left;">Tipo</th>
                            <th style="padding: 10px; text-align: left;">Fecha</th>
                            <th style="padding: 10px; text-align: left;">Hora de Inicio</th>
                            <th style="padding: 10px; text-align: left;">Estado</th>
                            <th style="padding: 10px; text-align: left;">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tablaCitas">
                        <% if (Array.isArray(citas) && citas.length > 0) { %>
                            <% citas.forEach(cita => { %>
                                <tr style="border-bottom: 1px solid #ddd;">
                                    <td style="padding: 10px;"><%= cita.nombre_paciente %> <%= cita.apellido_paciente %></td>
                                    <td style="padding: 10px;">Consulta</td> <!-- O ajusta según sea necesario -->
                                    <td style="padding: 10px;"><%= cita.fecha %></td>
                                    <td style="padding: 10px;"><%= cita.hora %></td>
                                    <td style="padding: 10px;"><%= cita.estado %></td>
                                    <td style="padding: 10px;">
                                        <button class="edit-button" style="padding: 5px 10px; background-color: #ffc107; color: white; border: none; border-radius: 4px; cursor: pointer;" data-id="<%= cita.id %>">Editar</button>
                                        <button class="delete-button" style="padding: 5px 10px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;" data-id="<%= cita.id %>">Eliminar</button>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 10px;">No hay citas disponibles.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</div>

<!-- Modal para añadir/editar cita -->
<div id="modalCitas" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="modalTitle">Añadir Cita</h2>
        <form id="formCitas">
            <input type="hidden" id="citaId" name="id"> <!-- Campo oculto para el ID de la cita -->
            <div class="form-group">
                <label for="nombre">Paciente</label>
                <input type="text" id="nombre" name="nombre" required>
            </div>
            <div class="form-group">
                <label for="tipoProcedimiento">Tipo de Procedimiento</label>
                <select id="tipoProcedimiento" name="tipoProcedimiento" required>
                    <option value="">Seleccione el tipo</option>
                    <option value="Consulta">Consulta</option>
                    <option value="Cirugía">Cirugía</option>
                </select>
            </div>
            <div class="form-group">
                <label for="fecha">Fecha</label>
                <input type="date" id="fecha" name="fecha" required>
            </div>
            <div class="form-group">
                <label for="hora">Hora de Inicio</label>
                <input type="time" id="hora" name="hora" required>
            </div>
            <div class="form-group">
                <label for="estado">Estado</label>
                <select id="estado" name="estado" required>
                    <option value="">Seleccione el Estado</option>
                    <option value="Pendiente">Pendiente</option>
                    <option value="Aceptado">Aceptado</option>
                </select>
            </div>
            <button type="submit" class="btn-guardar">Guardar</button>
        </form>
    </div>
</div>

<%- include('../_partials/footer') %>